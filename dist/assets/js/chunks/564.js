"use strict";(self.webpackChunksg_blocks=self.webpackChunksg_blocks||[]).push([[564],{7564:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var r=n(9196),l=n.n(r),o=n(2175),a=n(5609),i=n(9818),u=n(5736),c=n(4333),s=n(2539),d=n(4652);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){var r;return r=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==m(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=[{title:"Marges internes",attribute:"padding"},{title:"Marges Externes",attribute:"margin"}];const b=function(e){var t,n=e.attributes,r=e.setAttributes,o=n.columns,i=n.slider,u=n.sliderBreakpoint;return l().createElement(l().Fragment,null,l().createElement(a.PanelBody,null,l().createElement(a.__experimentalDivider,null),!i||!!i&&!!u&&u>0&&l().createElement(l().Fragment,null,l().createElement(a.RangeControl,{label:"Colonnes",value:null!==(t=o.default)&&void 0!==t?t:0,onChange:function(e){r({columns:p(p({},o),{},{default:e})})},min:1,max:5}))),l().createElement(s.Z,{attributes:n,setAttributes:r,spacingsOptions:!i||i&&u&&u>0?[].concat(y,[{title:"Espacement interne",attribute:"gap"}]):y}),l().createElement(a.PanelHeader,{label:"Responsive Design"}),l().createElement(d.Z,null,(function(e){var t;return l().createElement("div",null,!i||i&&u&&u>0&&l().createElement(a.PanelBody,null,l().createElement(a.RangeControl,{label:"Colonnes",value:null!==(t=o[e.name])&&void 0!==t?t:0,onChange:function(t){r({columns:p(p({},o),{},v({},e.name,t))})},min:1,max:5})),l().createElement(s.Z,{breakpoint:e.name,attributes:n,setAttributes:r,spacingsOptions:!i||i&&u&&u>0?[].concat(y,[{title:"Espacement interne",attribute:"gap"}]):y}))})))};function g(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const w=function(e){var t,n,o,u=e.attributes,c=e.setAttributes,s=e.currentPost,d=e.posts,m=u.postNumber,f=u.relatedPostType,p=u.relatedTaxonomy,v=u.excludedIds,y=s.type,b=(n=(0,i.useSelect)((function(e){var t,n,r=(0,e("core").getPostTypes)({per_page:-1}),l=(null==r||null===(t=r.find((function(e){return e.slug===f})))||void 0===t?void 0:t.taxonomies)||null,o=(null==r||null===(n=r.find((function(e){return e.slug===y})))||void 0===n?void 0:n.taxonomies)||[];return[null==r?void 0:r.filter((function(e){return e.taxonomies.some((function(e){return(null==o?void 0:o.includes(e))||!1}))})),l?o.filter((function(e){return l.includes(e)})):[]]}),[s,f]),o=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,i=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){c=!0,l=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw l}}return i}}(n,o)||E(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=b[0],w=b[1];return(0,r.useEffect)((function(){var e;!((null==h?void 0:h.length)>0)||f&&h.map((function(e){return e.slug})).includes(f)||c({relatedPostType:h?null===(e=h[0])||void 0===e?void 0:e.slug:void 0}),!((null==w?void 0:w.length)>0)||p&&w.includes(p)||c({relatedTaxonomy:w?w[0]:void 0})}),[h,w]),l().createElement(l().Fragment,null,l().createElement(a.PanelBody,null,l().createElement(a.PanelRow,null,l().createElement(a.SelectControl,{label:"Post Type",value:f,onChange:function(e){return c({relatedPostType:e})},options:null==h?void 0:h.map((function(e){return{value:e.slug,label:e.name}}))})),l().createElement(a.PanelRow,null,l().createElement(a.SelectControl,{label:"Taxonomy",value:p,onChange:function(e){return c({relatedTaxonomy:e})},options:null==w?void 0:w.map((function(e){return{value:e,label:e.charAt(0).toUpperCase()+e.slice(1)}}))})),l().createElement(a.PanelRow,null,l().createElement(a.__experimentalNumberControl,{label:"Nombre d'éléments",value:m,onChange:function(e){return c({postNumber:e})},min:0,max:20})),l().createElement(a.__experimentalDivider,null),d&&l().createElement(l().Fragment,null,l().createElement(a.PanelRow,null,l().createElement(a.TextControl,{label:"IDs exclus",placeholder:"Ex: 1, 2, 3",value:null!==(t=null==v?void 0:v.join(", "))&&void 0!==t?t:"",onChange:function(e){return c({excludedIds:e.split(", ")})}})),d.map((function(e){return l().createElement(a.PanelRow,{key:e.postId},l().createElement("span",null,e.postTitle,l().createElement(a.Button,{isDestructive:!0,icon:"remove",onClick:function(){return c({excludedIds:[].concat(g(null!=v?v:[]),[e.postId])})}})))})),l().createElement("div",null))))};function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const S=function(e){var t,n,o=e.attributes,i=e.setAttributes,u=o.sliderAutoplay,c=o.sliderDisplayNavElements,s=o.slider,d=o.sliderBreakpoint,m=(t=(0,r.useState)(!!u),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,i=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){c=!0,l=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw l}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=m[0],p=m[1];return l().createElement(l().Fragment,null,l().createElement(a.PanelBody,null,l().createElement(a.ToggleControl,{label:"Slider",checked:!!s,onChange:function(e){i({slider:e})}}),l().createElement(a.RangeControl,{label:"Largeur d'écran en px pour pour l'activation du slider",help:"Largeur d'écran en dessous de laquelle le slider s'active, laissez 0 pour l'activer tout le temps",value:d,min:0,max:2048,onChange:function(e){i({sliderBreakpoint:e})}}),l().createElement(a.ToggleControl,{label:"Afficher les boutons de navigation",checked:!!c,onChange:function(e){i({sliderDisplayNavElements:e})}}),l().createElement(a.ToggleControl,{label:"Autoplay",checked:!!u,onChange:function(e){return p(e)}}),l().createElement(a.RangeControl,{label:"Duree de l'animation en ms",disabled:!f,value:u,min:500,max:1e4,onChange:function(e){i({sliderAutoplay:e})}})))};var x=n(3152),C=n(1412);function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,i=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){c=!0,l=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw l}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I.apply(this,arguments)}var O=[["sg/container",{Tag:"article"},[["sg/container",{Tag:"div"},[["sg/featured-image",{imageSource:"medium_medium",aspectRatio:"4 / 3",sizes:{default:480}}]]],["core/post-title"],["core/post-excerpt",{moreText:"",showMoreOnNewLines:!1}]]]],j=function(e){var t=e.className,n=void 0===t?"":t,r=(0,o.useInnerBlocksProps)({className:n},{template:O});return l().createElement("li",r)};function k(e){var t=e.blocks,n=e.blockContextId,r=e.isHidden,a=e.className,i=void 0===a?"":a,u=e.setActiveBlockContextId,c=(0,o.__experimentalUseBlockPreview)({className:i,blocks:t}),s=function(){u(n)},d={display:r?"none":void 0};return l().createElement("li",I({},c,{className:c.className+" "+i,tabIndex:0,role:"button",onClick:s,onKeyDown:s,style:d}))}var N=(0,r.memo)(k);const T=function e(t){var n=t.clientId,s=t.attributes,d=t.setAttributes,m=s.className,f=s.relatedPostType,p=s.relatedTaxonomy,v=s.postNumber,y=s.excludedIds,g=s.slider,E=s.sliderBreakpoint,h=s.sliderAutoplay,A=s.sliderDisplayNavElements,_=(0,c.useInstanceId)(e),I=P((0,r.useState)(null),2),O=I[0],k=I[1],T=P((0,r.useState)(!1),2),B=T[0],D=T[1],R=(0,r.useRef)(null),q=(0,i.useSelect)((function(e){return e("core/editor").getCurrentPost()}),[]),F=(0,i.useSelect)((function(e){return e("core/block-editor").getBlocks(n)}),[]),M=(0,x.f6)(s),L=(0,o.useBlockProps)();L.className="".concat(L.className.replace(s.className,""));var z=(0,i.useSelect)((function(e){var t=e("core").getEntityRecords;return f&&p&&q?t("sg","related_posts",{related_post_type:f,related_taxonomy:p,post_number:v||-1,post_id:q.id,excluded_ids:y}):[]}),[f,p,v,q.id,y]),U=(0,r.useMemo)((function(){return null==z?void 0:z.map((function(e){return{postType:e.type,postId:e.id,postTitle:e.title,queryId:e.query_id}}))}),[z]);return(0,r.useEffect)((function(){d({queryId:_})})),(0,r.useEffect)((function(){var e=function(){var e=window.innerWidth;D(e<=E||0===E)};return g?(window.addEventListener("resize",e),e()):(D(!1),window.removeEventListener("resize",e)),function(){window.removeEventListener("resize",e)}}),[g,E]),(0,r.useEffect)((function(){if(g&&R.current&&B){var e,t,n=new C.default(R.current,{draggable:!0,auto:"number"==typeof h?h:void 0,navigation:{prev:Array.from(null===(e=R.current)||void 0===e?void 0:e.querySelectorAll("[data-direction=prev]")),next:Array.from(null===(t=R.current)||void 0===t?void 0:t.querySelectorAll("[data-direction=next]"))}});return n.start(),function(){n.stop()}}}),[g,B,R.current]),l().createElement(l().Fragment,null,l().createElement(o.InspectorControls,null,l().createElement(a.PanelBody,null,l().createElement(a.TabPanel,{className:"query-related-tab-panel",activeClass:"active-tab",tabs:[{name:"query",title:"Requête"},{name:"layout",title:"Affichage"},{name:"slider",title:"Slider"}]},(function(e){return l().createElement("div",null,l().createElement("h3",null,e.title),"layout"===e.name&&l().createElement(b,{attributes:s,setAttributes:d}),"query"===e.name&&l().createElement(w,{attributes:s,setAttributes:d,currentPost:q,posts:U}),"slider"===e.name&&l().createElement(S,{attributes:s,setAttributes:d}))})))),l().createElement("div",L,U&&U.length>0?l().createElement("div",{"data-sg-slider":g?E:void 0,className:"sg-query-related".concat(g?" sg-swiper":"").concat(B?" sg-swiper--started":""),ref:R},l().createElement("ul",{className:"sg-query-related__list ".concat(M," ").concat(m||""," ").concat(g?"sg-swiper__wrapper":"")},U.map((function(e){var t,n;return l().createElement(o.BlockContextProvider,{key:e.postId,value:e},e.postId===(O||(null===(t=U[0])||void 0===t?void 0:t.postId))?l().createElement(j,{className:g?"sg-swiper__slide":void 0}):null,l().createElement(N,{className:g?"sg-swiper__slide":void 0,blocks:F,blockContextId:e.postId,setActiveBlockContextId:k,isHidden:e.postId===(O||(null===(n=U[0])||void 0===n?void 0:n.postId))}))}))),!!A&&!!g&&l().createElement(l().Fragment,null,l().createElement("button",{className:"sg-swiper__nav sg-icon-cheveron-left","data-direction":"prev"}),l().createElement("button",{className:"sg-swiper__nav sg-icon-cheveron-right","data-direction":"next"}))):l().createElement("div",{className:"sg-query-related__empty"},l().createElement("h3",null,(0,u.__)("SG Boucle de Post liés")),l().createElement("p",null,(0,u.__)("Aucun post trouvé")),l().createElement(w,{attributes:s,setAttributes:d,currentPost:q,posts:U}))))}}}]);